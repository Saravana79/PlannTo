  <%if @items %>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="comparetbl" style="table-layout: fixed">
  <tr>
    <td class="rowline" valign="bottom" align="center" width="200px">

    </td>
  
    <%@items.each_with_index do |item, index|%>
      <%=render :partial =>"items/basic_info",:locals => {:item => item, :count => index+1} %>
      <%break if index == 3%>
    <%end%>
    <%if empty_boxes_required?(@items)%>
      <%for i in empty_boxes_count(@items)..4%>
        <%=render :partial =>"items/add_more_items",:locals => {:itemtype =>@item1.itemtype.itemtype, :count => i } %>
      <%end%>
    <%end%>
  </tr>
  <%@attributes.group_by(&:category_name).each do |group, attributes|%>
    <%if group_display_required?(attributes.collect(&:id), @ids)%>
      <tr>
        <td id="comp-info-start-here" class="high insidebox titlename bordered" colspan="5" width="1000px"><b><%=group%></b></td>
      </tr>
      <%attributes.each do |att|%>
        <%if  attribute_display_required?(@ids, att.id)%>
          <tr>
            <td id="comp-info-start-here" class="top insidebox name bordered" width="200px"><b><%=att.name%></b></td>
            <%@items.each_with_index do |compare_item, index|%>
              <td align="center" class="high insidebox bordered attributeInfo<%=index+1%>" width="200px"> <div class="price"><%=raw show_item_value(compare_item, att)%></div></td>
              <%break if index == 3%>
            <%end%>
            <%if empty_boxes_required?(@items)%>
              <%for i in empty_boxes_count(@items)..4%>
                <td align="center" class="high insidebox bordered" width="200px"> <div class="price"></div></td>
              <%end%>
            <%end%>
          </tr>
        <%end%>
      <%end%>
    <%end%>
  <%end%>
</table>
<%end%>

<div id="compare_popup" style="display:none;">
 <%=render :partial =>"items/compare_popup_item_select",:locals => {:count =>"#{params[:ids].split(",").size rescue  "1"}"} %>

</div>

<script>
$(".ui-dialog-content").dialog('destroy')
var ids = '<%= params[:ids] %>'

  if (ids.toString().split(",")[0] == '')
        {
         var size = 2
        }
        else
        {
         var size = 1
        }
if (ids.toString().split(",").length < size )
{
$('#compare_popup').dialog({modal: true,height: 480,width: 305 });
 $('.Close_dialog').show();
        $('.ui-dialog-titlebar').hide();
   }
</script>
<%if @items %>
<% if !@contents.blank? %>
  <center> <h2> Top Contents </h2> </center>
    
  <div id="content_all">  
 <div style="border-bottom:solid 1px #e4e4e4;;clear:both;" id="contentsList">
    <%= render :partial => 'contents/contents'%>
     <a id="content_next" style="display:none"></a>
      <%= hidden_field_tag :page_pagination,2%>
  </div> 
   <span id="spinner1" style="padding:0px 0px 0px 300px;display:none">
     <%= image_tag '/images/ajax-loader.gif' %>
</span>
</div>
  <script>
  
    $(window).scroll(function () {
 
 
     if (!running && $(window).scrollTop() >= $('#content_all').height() - $(window).height()) {
   
             running = true;
            $.ajax(
              {
                url: "/items/compare?type=scroll" + "&ids=<%= params[:ids]%>" + '&page=' + $("#page_pagination").val(),
                type: "get",
                dataType: "script",
                before: $('#spinner1').show(),
                success: function(data){$('#spinner1').hide();
                 
                  }
              });
              return false
            //lnk.click();
       }
        });
      
    </script>


<%end%>
<%end%>
</div>
