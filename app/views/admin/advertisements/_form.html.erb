<%= form_for [:admin, @advertisement] do |f| %>
    <% if @advertisement.errors.any? %>
        <div id="error_explanation"%>
        <%= "#{pluralize(@advertisement.errors.count, "error")} prohibited this product from being saved:" %>
        <ul>
          <% @advertisement.errors.full_messages.each do |msg| %>
              <li> <%= msg %> </li>
          <% end %>
        </ul>
        </div>
    <% end %>
    <center><h2> Advertisement </h2></center>

    <div class="main_form">
      <div class="fields-div">
        <div class="title_header float_lft">Advertisement Type :</div>
        <div>
          <%= f.radio_button :advertisement_type, 'static', :checked => true %>Static
          <%= f.radio_button :advertisement_type, 'dynamic' %>Dynamic
          <%= f.radio_button :advertisement_type, 'Offer' %>Offer
          <%= f.radio_button :advertisement_type, 'Features' %>Features
          <%= f.radio_button :advertisement_type, 'Content' %>Content
        </div>
      </div>

      <div class="fields-div">
        <div class="title_header float_lft">Name :</div>
        <div class="float_lft"> <%= f.text_field :name %> </div>
      </div>

      <%= hidden_field_tag 'ad_item_id' %>

      <div class="fields-div" id="reviewProducts">

        <div class="title_header float_lft">Product :</div>
        <div class="taggingdiv">
          <ul id="ad_product_list" class="tagging"></ul>
          <div class="float_lft " id="displayTagBox">
            <input placeholder="Start Typing for suggestions.." type="text" value="" id="ad_product"/>
          </div>
        </div>
      </div>

      <div class="fields-div">
        <div class="title_header float_lft">Start Date :</div>
        <div>
          <%= f.text_field :start_date %></div>
      </div>
      <div class="fields-div">
        <div class="title_header float_lft">End Date :</div>
        <div>
          <%= f.text_field :end_date %></div>
      </div>

      <br/>

      <div class="files-div">
        <%= link_to "Add One more file", "javascript:void(0)", :id => "add_another_file", :style => 'clear: both;' %>
        <% @advertisements && @advertisements.each do |a| %>
            <% @advertisement = a %>
            <div class="file-div">
              <div>
                <div class="title_header float_lft">Advertisement Size :</div>
                <div class="float_lft">
                  <%= select_tag 'advertisement[ad_size][]', options_for_select([["250*250", "250*250"], ["300*300", "300*300"], ["1000*600", "1000*600"]]), :placeholder => "" %>
                </div>
                <%#= f.select "ad_size[]",["250*250","300*300","1000*600"],:style => "margin-left:5px;width:400px;",:placeholder => "", :multiple => true%>
              </div>
              <div class="fields-div">
                <div class="title_header float_lft">Image :</div>
                <div class="float_lft">
                  <%= f.file_field :upload_image, name: "advertisement[upload_image][]" %>
                </div>
              </div>
            </div>
        <% end %>
      </div>

      <script type="text/javascript">
          $("#add_another_file").live("click", function () {
              a = $(".file-div").clone();
              remove_link = $("<a class='remove-file'>Remove<a>");
              remove_link.bind("click", function () {
                  $(this).parent().remove();
              })
              a.removeClass("file-div")
              a.children().find('input,select').each(function () {
                  $(this).val('');
              });
              remove_link.appendTo(a);
              a.appendTo(".files-div");
          })
      </script>
      <div class="fields-div" style="clear: both;">
        <div class="title_header float_lft">Click Url :</div>
        <div>
          <%= f.text_field :click_url %></div>
      </div>
      <div class="fields-div">
        <div class="title_header float_lft">Budget[per day] :</div>
        <div>
          <%= f.text_field :budget %></div>
      </div>
      <div class="fields-div">
        <div class="title_header float_lft">Bid[CPM/CPC/CPA] :</div>
        <div>
          <%= f.radio_button :bid, 'CPM', :checked => true %>CPM
          <%= f.radio_button :bid, 'CPC' %>CPC
          <%= f.radio_button :bid, 'CPA' %>CPA
        </div>
      </div>

      <div class="fields-div">
        <div class="title_header float_lft">Cost :</div>
        <div>
          <%= f.text_field :cost %></div>
      </div>


        <%= f.submit 'Add Advertisement', :class => 'btn_submitanswer', :id => "publishanswer" %>



        </div>


    <script>
        $("#advertisement_start_date").datepicker({ dateFormat: 'dd-mm-yy' });
        $("#advertisement_end_date").datepicker({ dateFormat: 'dd-mm-yy' });

        $(document).ready(function () {

            <%if @advertisement.nil?%>
            settings = {
                close: true, addButton: false,
                url: "/search/autocomplete_items",
                editMode: false, multiple: true,
                hidden_field: "#ad_item_id"
            };
            $.textTagger("#ad_product", "#ad_product_list", settings);

            <% unless @item.blank? %>
            $.addTag("#ad_product", "#ad_product_list", settings, "<%= @item.name %>", "<%= @item.id %>", false);
            $.addIdToField(settings.hidden_field, "<%= @item.id %>", false);
            $("#ad_product_list li:first span a.icon_close_tagging").remove();
            <% end %>
            <%else%>
//error is here

            var settings = {has_parent: true, close: true, addButton: false, url: "/search/autocomplete_items", editMode: false, multiple: true,
                hidden_field: "#ad_item_id"};
            <%unless @items.nil? %>
            <% @items.each do |item| %>

            $.addTag("ad_product", "ad_product_list", settings, "<%= item.name %>", "<%= item.id %>", false);
            $.addIdToField(settings.hidden_field, "<%= item.id %>", true);
            //$("#article_create_product_list li:first span a.icon_close_tagging").remove();
            <%end%>
            <%end%>
            $.textTagger("#ad_product", "#ad_product_list", settings);
//ends
            <%end%>


        });
    </script>
<% end %>

<style type="text/css">
    .main_form {
        margin: 38px 0 0 54px;
        width: 600px
    }

    #new_advertisement h2 {
        font-size: 20px;
        margin: 22px;
    }

    .title_header.float_lft {
        font-size: 13px;
        text-align: right;
    }

    .main_form .fields-div {
        line-height: 40px;
    }

    .title_header {
        width: 150px;
        clear: both;
        margin: 10px 10px 0 0;;
    }

    .fields-div input, .fields-div select {
        width: 250px;
    }

    .remove-file {
        cursor: pointer;
        color: blue;
        float: left;
    }

    #add_another_file {
        clear: both;
        font-size: 13px;
        padding: 0px 388px 0;
        position: absolute;
        text-decoration: underline;
    }
</style>