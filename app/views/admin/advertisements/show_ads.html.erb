<!DOCTYPE html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Advt 300</title>

  <link href="/assets/ads/style.css" type="text/css" rel="stylesheet" media="all"/>


  <script type="text/javascript" language="javascript" src="/assets/ads/jquery-1.8.2.min.js"></script>

</head>

<body>

<div class="advt-block">
  <div class="advt-300">
    <% if @item_details.count != 0 %>
        <div class="list_carousel">
          <ul id="foo3">
            <% @item_details.each_with_index do |item_detail, indx| %>
                <li class="item_details" id="item_detail_<%= indx + 1 %>">
                  <div class="advt-box">
                    <div class="logo"><a href="#"><img src="<%= @vendor_image_url %>" alt=""></a>
                    </div>
                    <div class="product-container">
                      <div class="product-img-left">
                        <a href="#"><img src="<%= item_detail.item.image_url %>" alt="" width="100px" height="100px"></a>
                      </div>
                      <div class="product-txt-right">
                        <h3><%= item_detail.ItemName %></h3>

                        <p class="price">Rs. <%= item_detail.price %></p>

                        <p class="btn">
                          <a href="http://localhost:3000/history_details?detail_id=<%= item_detail.id %>&iid=<%= item_detail.item.id %>" class="shop-now">Shop
                            Now</a></p>

                      </div>
                    </div>
                    <div class="product-txt-desc">
                      <p>Bold and colorful 13" laptop built for affordable, on-the-go entertainment.</p></div>
                  </div>
                </li>
            <% end %>
          </ul>
          <div class="clearfix"></div>
          <a id="prev3" class="prev" href="#">&lt;</a>
          <a id="next3" class="next" href="#">&gt;</a>

          <div id="pager2" class="pager">
            <% [*1..@item_details.count].each do |each_loop| %>
                <a href="javascript:void(0)" id="<%= each_loop %>" class=""><span> <%= each_loop %></span></a>
            <% end %>
          </div>
        </div>
    <% else %>
        No Product Found
    <% end %>

  </div>
  <!-- end of advt-300 -->
</div>
<!-- end of advt-block -->


</body>
</html>


<script type="text/javascript">

    $(document).ready(function () {

        var stop_sliding = false

        $(".item_details").hide();
        $(".item_details").first().show();
        $(".item_details").first().addClass('active')
        $("#1").addClass('selected')


        $(".item_details").each(function (index) {

            if (index == 0)
                return

            var that = this;
            var t = setTimeout(function () {
                if (stop_sliding == false) {
                    $(".item_details").hide();
                    $(".item_details").removeClass('active')
                    $("#pager2 a").removeClass('selected')

                    split_div = $(that).attr('id').split('_')
                    $("#" + split_div[split_div.length - 1]).addClass('selected')

                    $(that).show();
                    $(that).addClass('active')
                    if (index == ($(".item_details").length - 1))
                        setTimeout(function () {
                            if (stop_sliding == false) {
                                $(".item_details").last().hide()
                                $(".item_details").removeClass('active')
                                $("#pager2 a").removeClass('selected')
                                $(".item_details").first().show();
                                $(".item_details").first().addClass('active')
                                $("#1").addClass("selected")
                            }
                        }, 5000)
                }
            }, 5000 * index);
        });

        $(".next").click(function () {
            var current_div = $(".item_details.active")
            $(".item_details").hide();
            $(".item_details").removeClass('active')
            $("#pager2 a").removeClass('selected')

            var splited_val = $(current_div).attr("id").split('_')

            if (parseInt(splited_val[splited_val.length - 1]) < $(".item_details").length) {
                $(current_div).next().show().addClass('active')
                split_div = $(current_div).next().attr("id").split('_')
                $("#" + split_div[split_div.length - 1]).addClass('selected')
            }
            else {
                $(".item_details").first().show().addClass('active')
                $("#1").addClass('selected')
            }
        });


        $(".prev").click(function () {
            var current_div = $(".item_details.active")
            $(".item_details").hide();
            $(".item_details").removeClass('active')
            $("#pager2 a").removeClass('selected')

            var splited_val = $(current_div).attr("id").split('_')

            if (parseInt(splited_val[splited_val.length - 1]) > 1) {
                $(current_div).prev().show().addClass('active')
                split_div = $(current_div).prev().attr("id").split('_')
                $("#" + split_div[split_div.length - 1]).addClass('selected')
            }
            else {
                $(".item_details").last().show().addClass('active')
                last = $(".item_details").length
                $("#" + last).addClass('selected')
            }
        });

        $("#pager2 a").click(function () {
            var that = this
            selected_id = $(that).attr("id")
            selected_div = $("#item_detail_" + selected_id)

            $(".item_details").hide();
            $(".item_details").removeClass('active')

            $(selected_div).show()
            $(selected_div).addClass('active')
            $("#pager2 a").removeClass('selected')
            $(that).addClass('selected')
        })

        $(".list_carousel").click(function () {
            stop_sliding = true
        })

    });

</script>