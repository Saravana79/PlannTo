<h1><%=@question.title%></h1>
<div id="preferencesTag"><ul></ul></div> <%if can_update_preference?(@buying_plan)%><a id="editPreferences" class="btn_submitanswer" href="">Edit My Preferences</a><%end%><br/><br/><br/>
<div id="tabs">

  <ul><li id='giveAdviceTag' style= 'line-height:35px;' class='textboxlist-bit textboxlist-bit-box textboxlist-bit-box-deletable' >Add a Recommendation</li></ul>
  <p>My Question: <%=@question.question%></p>
  <p>Advices</p>
  <div id="giveAdviceDialog" title="Add a recommendation" style="display:none"></div>
  <div class="answerList">
    <%=display_empty_row(@answers.size).html_safe%>
    <%@answers.each_with_index do |ans, index|%>
      <div class="box" id="box_<%=index%>"><%=ans.answer%><br/>
        <%ans.recommendations.each_with_index do |reco, index|%>
          <p>Recommendations<img class="profile_photo_img" width="50" height="50" alt="image" src="<%=image_url(reco.item)%>"/> <%=reco.item.name%></p>
        <%end%></div>
      <%end%>
  </div>
</div>

<script type="text/javascript">
  $('#giveAdviceTag').live('click', function(){
    $.get('/preferences/give_advice',{question_id: <%=@question.id%>},null,"script");
  })

  $('#editPreferences').live('click', function(e){
    e.preventDefault()
    $.get('/preferences/edit_preference',{id: <%=@buying_plan.id%>},null,"script");
    return false

  })
</script>
<script type="text/javascript">
<%@preferences_list.each do |preference|%>
    var lineHeight = "";
    var searchCriteria = "";
    var tagId = "";
    var searchName = "<%=preference[:search_name]%>"
  <%if preference[:value_type] == "Between"%>
      searchCriteria = ""
      searchCriteria   = searchCriteria + "<%=preference[:search_criteria]%>"
      var className = "middlebg attributeTag"
      var list = "<li id='" + tagId + "'" + " class='" + className +"'><span class='title_txt'>" + searchName + "<a id= 'deleteTag' class='icon_close'></a></span>" + searchCriteria + "</li>" ;
      //      var className = "attributeTag textboxlist-bit textboxlist-bit-box textboxlist-bit-box-deletable "
      //     var list = "<li id='" + tagId + "'" + lineHeight + " class='" + className + "'>" + searchName + searchCriteria + "<a id= 'deleteTag' class='textboxlist-bit-box-deletebutton'></a></li>" ;
  <%elsif (preference[:value_type] == "GreaterThan" || preference[:value_type] == "LessThen")%>
      searchCriteria = ""
      searchCriteria   = searchCriteria + "<%=preference[:search_criteria]%>"
      var value = searchCriteria
      var searchCriteria = "<span class='txt_subcategories'>" + value +"</span>"
      //var className = "attributeTag textboxlist-bit textboxlist-bit-box textboxlist-bit-box-deletable "
      var className = "middlebg attributeTag"
      var list = "<li id='" + tagId + "'" + " class='" + className +"'><span class='title_txt'>" + searchName + "<a id= 'deleteTag' class='icon_close'></a></span>" + searchCriteria + "</li>" ;
  <%elsif (preference[:value_type] == "ListOfValues" || preference[:value_type] == "manufacturer")%>
      var value   = "<%="#{preference[:value]}"%>"    
      var selectedList = value.split(',')
      var searchCriteria = ""
      var anchorId
      searchCriteria = searchCriteria +  ""
      var spanHTML = ""
      var updatedSearchList= [];
      $.each(selectedList, function(index, value) {
        updatedSearchList.push( value)
      })
      spanHTML = spanHTML + "<span class='txt_subcategories'>" + value + "</span>"
      searchCriteria = searchCriteria + spanHTML
           var className = "middlebg attributeTag"
          var list = "<li id='" + tagId + "'" + " class='" + className +"'><span class='title_txt'>" + searchName + "</span>" + searchCriteria + "</li>" ;


  <%else%>
      var list = "<li id='" +tagId +"' class='middlebg attributeTag' ><span class='title_txt'>" + searchName + "</span></li>" ;
  <%end%>
    $(list).appendTo('#preferencesTag ul');
<%end%>
  //$("#deleteTag").hide()

</script>

